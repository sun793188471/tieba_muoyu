# 🐟 百度贴吧优化摸鱼体验

> 一个 Tampermonkey 油猴脚本，为百度贴吧提供全面的显示优化和功能增强，让你在工作时间优雅地浏览贴吧。

**版本**: v1.0.0 | **协议**: MIT | **适用**: 百度贴吧 (`tieba.baidu.com`)

---

## 📸 效果预览

### Excel 伪装模式 — 贴吧帖子列表

将贴吧帖子列表伪装为 Excel 在线表格，页面标题也会变为 "Book1 - Excel Online"。底部 sheet 标签可切换不同的关注贴吧。

![Excel模式-帖子列表](assets/excel-threads.png)

### Excel 伪装模式 — 首页信息流（隐藏图片）

首页信息流以表格形式展示，按下 `E` 键可隐藏所有图片，仅显示 `[图片]` 占位标签。

![Excel模式-首页-隐藏图片](assets/excel-home-noimg.png)

### Excel 伪装模式 — 首页信息流（显示图片）

再次按下 `E` 键恢复图片显示，图片以缩略图形式嵌入表格单元格中，点击可全屏查看。

![Excel模式-首页-显示图片](assets/excel-home-img.png)

---

## 🚀 安装方法

### 前置要求

安装以下任一浏览器扩展：

| 扩展 | 支持浏览器 |
|------|-----------|
| [Tampermonkey](https://www.tampermonkey.net/) | Chrome / Edge / Firefox / Safari |
| [Violentmonkey](https://violentmonkey.github.io/) | Chrome / Edge / Firefox |

### 安装步骤

1. 安装上述浏览器扩展
2. 点击扩展图标 → 新建脚本
3. 将 `tieba.js` 的完整内容粘贴进去
4. 保存（Ctrl+S）
5. 访问 [百度贴吧](https://tieba.baidu.com/)，脚本自动生效

---

## ⌨️ 快捷键一览

| 快捷键 | 功能 | 状态持久化 |
|--------|------|:----------:|
| `R` | 切换 Excel 伪装模式 | ✅ |
| `Q` | 切换隐藏/显示头像 | ✅ |
| `E` | 切换隐藏/显示图片 | ✅ |
| `D` | 切换暗黑模式 | ✅ |

> **状态持久化**：按下快捷键后的状态会自动保存，跳转到新页面时会自动恢复，无需重复操作。

---

## 📦 功能模块详解

脚本包含以下功能模块：

### 一、界面优化

#### 1. Excel 伪装模式 `快捷键 R`

核心功能，将整个贴吧页面伪装为 Excel Online 表格界面：

- **完整的 Excel UI**：工具栏、Ribbon 功能区、公式栏、单元格选中高亮
- **页面标题伪装**：自动将浏览器标签页标题改为 "Book1 - Excel Online"
- **智能数据提取**：根据页面类型（首页 / 帖子列表 / 帖子详情）自动提取对应字段
- **Sheet 标签切换**：
  - 第一个 tab 显示当前页面内容
  - 后续 tab 为你关注的贴吧（最多 20 个），点击可直接在页面内加载该贴吧帖子列表
  - 非首页时，最前方显示 "🏠 首页" 导航标签，可直接返回首页
- **帖子内联打开**：点击帖子链接不会跳转页面，而是创建新的 tab 在当前 Excel 框架内加载帖子内容，tab 名为帖子标题（最多 5 个帖子 tab）
- **楼中楼展开**：帖子详情中每层楼下方可展开楼中楼回复，显示回复人、被回复人关系
- **图片缩略图**：表格中的图片显示为小缩略图，点击可打开全屏查看器
- **暗黑模式适配**：所有 Excel 元素均有完整的暗黑模式样式

#### 2. 隐藏头像 `快捷键 Q`

隐藏帖子列表和帖子详情中的所有用户头像，减少视觉干扰。

#### 3. 隐藏图片 `快捷键 E`

隐藏帖子内的所有图片，图片位置显示 `[图片]` 占位标签。在 Excel 模式中同样生效。

#### 4. 图片缩放

限制帖内图片最大显示宽度（默认 250px），鼠标悬停时自动放大到 2 倍宽度。可在高级设置中自定义宽度。

#### 5. 隐藏版头

隐藏贴吧顶部横幅、推荐位、搜索栏等装饰性区域，让内容区域更加突出。

#### 6. 隐藏右侧栏

隐藏页面右侧的广告和推荐栏，内容区域自动扩展至全宽。

#### 7. 折叠楼中楼

当楼中楼回复区域超过设定高度（默认 200px）时自动折叠，显示"展开楼中楼"按钮。

#### 8. 字体大小调整

全局调整帖子内容、标题、楼中楼等区域的字体大小（默认 14px），可在高级设置中修改。

---

### 二、内容过滤

#### 9. 广告屏蔽

自动移除贴吧内置广告、推广帖子、下载提示等干扰元素。通过 CSS 和 DOM 清理双管齐下。

#### 10. 关键字屏蔽

按关键字过滤帖子标题和内容，支持：
- 普通文本匹配
- 正则表达式匹配（以 `/` 开头）
- 通过油猴菜单 "关键字管理" 打开管理面板，每行一个关键字

#### 11. 黑名单

屏蔽指定用户的所有帖子和回复：
- 在帖子详情页用户名旁显示 `[屏蔽]` 按钮，一键拉黑
- 通过油猴菜单 "黑名单管理" 打开管理面板，可手动添加/移除

---

### 三、主题

#### 12. 暗黑模式 `快捷键 D`

完整的深色主题，覆盖贴吧全部页面元素，包括：
- 帖子列表、帖子详情、楼中楼
- 导航栏、分页器、侧栏
- 设置面板、扩展坞
- Excel 伪装模式全部组件
- 自动与护眼模式互斥

#### 13. 护眼模式

绿色护眼主题，将页面背景和各组件改为柔和的绿色调。开启暗黑模式时自动关闭。

---

### 四、增强功能

#### 14. 图片增强查看器

全屏图片查看器，功能包括：
- **滚轮缩放**：鼠标滚轮放大/缩小（10% 步进，范围 10%~1000%）
- **拖拽平移**：放大后可通过鼠标拖拽移动图片位置
- **旋转**：支持顺时针/逆时针 90° 旋转
- **重置**：一键恢复到原始大小和位置
- **上一张/下一张**：在当前页面的所有图片中导航
- **ESC 关闭**：按 ESC 键或点击背景关闭

#### 15. 标记楼主

在帖子详情页中，楼主的发言会被特殊标记：
- 用户名旁显示橙色 "楼主" 徽章
- 楼主的帖子左侧添加金色边框高亮

#### 16. 自动翻页

滚动到页面底部时自动加载下一页内容（无需手动点击翻页），适用于帖子列表和帖子详情页。

#### 17. 新标签打开

帖子列表中的帖子链接默认在新标签页中打开（Excel 模式中不生效，Excel 模式使用内联打开）。

---

### 五、系统功能

#### 18. 设置面板

完整的可视化设置面板，打开方式：
- 页面右上角 "⚙ 摸鱼设置" 按钮
- 右侧浮动扩展坞 "⚙" 按钮
- 油猴菜单 "贴吧摸鱼设置"

面板包含四个标签页：
| 标签 | 内容 |
|------|------|
| 基础设置 | 各功能模块的开关，按分组排列 |
| 高级设置 | 图片宽度、折叠高度、字体大小等数值参数 |
| 备份管理 | 导出/导入配置 JSON，方便跨浏览器迁移 |
| 关于 | 版本信息、快捷键提示 |

#### 19. 扩展坞

页面右下角固定的快捷按钮组：
- ↑ 回到顶部
- ↻ 刷新页面
- ⚙ 打开设置
- ↓ 回到底部

---

## ⚙️ 配置说明

### 基础设置（开关类）

| 设置项 | 默认值 | 所属分组 |
|--------|:------:|----------|
| 广告屏蔽 | ✅ 开启 | 内容过滤 |
| 关键字屏蔽 | ✅ 开启 | 内容过滤 |
| 黑名单功能 | ✅ 开启 | 内容过滤 |
| 隐藏头像 | ❌ 关闭 | 界面优化 |
| 隐藏图片 | ❌ 关闭 | 界面优化 |
| 帖内图片缩放 | ✅ 开启 | 界面优化 |
| 隐藏版头 | ✅ 开启 | 界面优化 |
| 隐藏右侧栏 | ✅ 开启 | 界面优化 |
| 折叠长楼中楼 | ✅ 开启 | 界面优化 |
| Excel 伪装模式 | ❌ 关闭 | 界面优化 |
| 暗黑模式 | ❌ 关闭 | 主题 |
| 护眼模式 | ❌ 关闭 | 主题 |
| 标记楼主 | ✅ 开启 | 增强功能 |
| 自动翻页 | ❌ 关闭 | 增强功能 |
| 新标签打开链接 | ✅ 开启 | 增强功能 |

### 高级设置（数值类）

| 设置项 | 默认值 | 说明 |
|--------|:------:|------|
| 图片最大宽度 | 250px | 帖内图片最大显示宽度 |
| 折叠高度阈值 | 200px | 楼中楼超过该高度时折叠 |
| 全局字体大小 | 14px | 页面全局字体大小 |

---

## 💡 使用建议

1. **日常摸鱼**：按 `R` 进入 Excel 模式 + 按 `E` 隐藏图片，远看完全是 Excel 表格
2. **深度阅读**：按 `D` 开启暗黑模式，减少屏幕刺眼感
3. **快速浏览**：在 Excel 模式下点击底部 Sheet 标签切换不同贴吧，无需打开新页面
4. **帖子阅读**：点击帖子链接直接在 Excel 框架内加载，点击"首页" tab 返回列表
5. **隐私保护**：广告屏蔽 + 隐藏头像 + 隐藏图片，最大限度减少视觉暴露

---
